@using WebApplication3.Models.Entities;

@model Order

@{

    ViewData["Title"] = "Order";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<div class="main">
    <div class="order-settings">
        <form id="order-settings-form" method="post">
            <input type="hidden" name="IsClose" value="false" />
            <div class="order-main-settings">
                <div class="arrow left-arrow"><</div>
                <table>
                    <tr>
                        <td>Дата</td>
                        <td>
                            Смена
                            @if (Model.IsClose) {
                                <p id="isClose">(Смена закрыта)</p>
                            }
                        </td>
                    </tr>
                    <tr>
                        <td><input type="date" name="Date" value="@Model.Date.ToString("yyyy-MM-dd")" required /></td>
                        <td>
                            <p><input type="radio" value="1" name="Shift" checked="@(Model.Shift==1)" />1</p>
                            <p><input type="radio" value="2" name="Shift" checked="@(Model.Shift==2)" />2</p>
                        </td>
                    </tr>
                    <tr>
                    </tr>
                </table>
                <div class="arrow right-arrow">></div>
                <div>
                    <button type="submit" formmethod="get">Find</button>
                </div>
            </div>

            <div class="order-staff">
                <table>
                    <tr>
                        <td>Диспетчер</td>
                        <td>Начальник</td>
                        <td>Горный мастер</td>
                    </tr>
                    <tr>
                        <td>
                            <select disabled="@Model.IsClose" name="Dispetcher">
                                @if (Model.Dispetcher == null) {
                                    <option selected disabled></option>
                                }
                                @foreach (var disp in ViewBag.Disps) {
                                    <option value="@disp.Id" selected="@(disp.Id==Model?.Dispetcher?.Id)">@disp.GetFIO()</option>
                                }
                            </select>
                        </td>
                        <td>
                            <select disabled="@Model.IsClose" name="Chief">
                                @if (Model.Chief == null) {
                                    <option selected disabled></option>
                                }
                                @foreach (var chief in ViewBag.Chiefs) {
                                    <option value="@chief.Id" selected="@(chief.Id==Model?.Chief?.Id)">@chief.GetFIO()</option>
                                }
                            </select>
                        </td>
                        <td>
                            <select disabled="@Model.IsClose" name="Masters" multiple>
                                @foreach (var master in ViewBag.Masters) {
                                    <option value="@master.Id" selected="@(Model?.MiningMaster.Where(x => x.Id == master.Id).Any())">@master.GetFIO()</option>
                                }
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3">
                            <button type="submit">Save</button>
                        </td>
                    </tr>
                </table>


            </div>
            <div class="order-area-choice">
                <ul class="order-area choice">
                    @foreach (var area in ViewBag.Areas) {
                        <li><input type="radio" value="@area.Id" name="OrderAreaId" checked="@(Model.Area.Id==area.Id)" /> @area.Name </li>
                    }
                </ul>



            </div>
        </form>
    </div>







    <div class="buttons-bar"></div>
    <div class="machinery-table table"></div>
</div>